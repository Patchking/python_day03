from bs4 import BeautifulSoup  


def mainline():
    site = ""
    with open("evilcorp.html", "r") as file:
        site = file.read()
    soup = BeautifulSoup(site, "html.parser")
    
    #Replace title
    soup.find("title").replace_with("Evil Corp - Stealing your money every day")

    #Add string <h1>Mr. Robot, you are hacked!</h1>
    userpronoun = soup.find("span", class_="name").contents[-1]
    userprefix = soup.find("span", class_="pronoun").string
    newh1tag = soup.new_tag("h1")
    newh1tag.string = f"{userprefix}{userpronoun}, you are hacked!"
    soup.insert(0, newh1tag)

    #Inject script
    injectedscript = ""
    with open("ex00_script.js", "r") as file:
        injectedscript = file.read()
    injectedscripttag = soup.new_tag("script")
    injectedscripttag.string = injectedscript
    soup.append(injectedscripttag)

    #Replace link on bottom
    bottomlinktag = soup.find("a", string = "Evil Corp")
    bottomlinktag["href"] = "https://mrrobot.fandom.com/wiki/Fsociety"
    bottomlinktag.string = "Fsociety"

    #My addition
    testfind = bottomlinktag.parent
    testfind.string = "Dont trust them! See "
    testfind.append(bottomlinktag)

    with open("evilcorp_hacked.html", "w") as file:
        file.write(soup.prettify())

def main():
    mainline()


if __name__ == "__main__":
    main()